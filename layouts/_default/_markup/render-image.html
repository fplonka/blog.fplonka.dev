{{- $src := .Destination -}}
{{- $image := resources.Get $src -}}

{{- if not $image -}}
  <p style="color: red;">
    <strong>Image not found:</strong> {{ $src }}
  </p>
{{- else -}}
  {{- /* e.g. resize to 2000px wide max, WebP, quality 80 */ -}}
  {{- $resized := $image.Resize "2000x webp q80" -}}

  <figure style="max-width: 100%; margin: 1em 0;">
    <img
      style="max-width: 100%; height: auto;"
      src="{{ $resized.RelPermalink | safeURL }}"
      alt="{{ .PlainText | safeHTML }}"
    />
    {{- with .Title -}}
      <figcaption>
        {{ . | safeHTML }}
      </figcaption>
    {{- end -}}
  </figure>
{{- end -}}

